<script src="{{ '/assets/js/simpleCart.js?version=2.1' | relative_url }}"></script>
<script async src="{{ '/assets/js/main.js' | relative_url }}"></script>
<script async src="{{ '/assets/js/style-picker.js' | relative_url }}"></script>
<script async src="{{ '/assets/js/add-to-cart.js' | relative_url }}"></script>
<script src="{{ '/assets/js/app.js' | relative_url }}"></script>
<script>
function showAlert(message, header = "Info") {
  const alert = document.getElementById('globalAlert');
  if (alert) {
    alert.header = header;
    alert.message = message;
    alert.buttons = ['OK'];
    alert.present();
  }
}
</script>
<script type="module">
document.addEventListener("DOMContentLoaded", () => {
  firebase.auth().onAuthStateChanged(async (user) => {
    if (!user) return;

    const params = new URLSearchParams(window.location.search);
    const orderId = params.get("orderId");
    if (!orderId) return;

    const db = firebase.firestore();
    const orderRef = db.collection("users").doc(user.uid).collection("orders").doc(orderId);
    const orderSnap = await orderRef.get();

    if (!orderSnap.exists) return;

    const data = orderSnap.data();
    const waConfirmed = data.waConfirmed || "Belum";

    if (waConfirmed === "Belum") {
      const alert = document.createElement('ion-alert');
      alert.header = 'Konfirmasi Pesanan';
      alert.message = 'Silakan konfirmasi pembayaran melalui WhatsApp untuk mempercepat proses.';
	  alert.buttons = ['OK'];

      document.body.appendChild(alert);
      await alert.present();
    }
  });
});
</script>
